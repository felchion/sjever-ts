// designed by Yu Jue
// Modified by snowman@SJ 12/06/2000
// Powered by Yu Jue 2000-08/09
// Powered again by YUJ@SJ 2001-05-06

#define HW "[1;37;40m"
#define BK "[0;30;40m"

#define FONTLIB 2

#include <ansi.h>

inherit NPC;

mixed keypos=({
	({ 0,0,0,0,0,0,0,0,0,0 }),
	({ 0,0,0,0,0,0,0,0,0,0 })
});

mixed keylen=({
	({  8, 4, 8, 8, 8, 8, 8, 8, 8, 8 }),
	({ 10, 4,10,10,10,10,10,10,10,10 })
});

mixed key=({
/*	({
		"â”Œâ– â– â– â”Œâ– â”Œâ– â– â– â”Œâ– â– â– â”Œâ– â”Œâ– â”Œâ– â– â– â”Œâ– â– â– â”Œâ– â– â– â”Œâ– â– â– â”Œâ– â– â– ",
		"â”‚â– â”â– â”‚â– â””â”€â”â– â””â”€â”â– â”‚â– â”‚â– â”‚â– â”€â”˜â”‚â– â”€â”˜â””â”€â”â– â”‚â– â”â– â”‚â– â”â– ",
		"â”‚â– â”‚â– â”‚â– â”Œâ– â– â– â”Œâ– â– â– â”‚â– â– â– â”‚â– â– â– â”‚â– â– â– ã€€ã€€â”‚â– â”‚â– â– â– â”‚â– â– â– ",
		"â”‚â– â”‚â– â”‚â– â”‚â– â”€â”˜â””â”€â”â– â””â”€â”â– â””â”€â”â– â”‚â– â”â– ã€€ã€€â”‚â– â”‚â– â”â– â””â”€â”â– ",
		"â”‚â– â– â– â”‚â– â”‚â– â– â– â”Œâ– â– â– ã€€ã€€â”‚â– â”Œâ– â– â– â”‚â– â– â– ã€€ã€€â”‚â– â”‚â– â– â– â”Œâ– â– â– ",
		"â””â”€â”€â”˜â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜ã€€ã€€â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜ã€€ã€€â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜"
	}),
	({
		"â”Œâ– â– â– â– â”Œâ– â”Œâ– â– â– â– â”Œâ– â– â– â– â”Œâ– ã€€â”Œâ– â”Œâ– â– â– â– â”Œâ– â– â– â– â”Œâ– â– â– â– â”Œâ– â– â– â– â”Œâ– â– â– â– ",
		"â”‚â– â”€â”â– â”‚â– â””â”€â”€â”â– â””â”€â”€â”â– â”‚â– ã€€â”‚â– â”‚â– â”€â”€â”˜â”‚â– â”€â”€â”˜â””â”€â”€â”â– â”‚â– â”€â”â– â”‚â– â”€â”â– ",
		"â”‚â– ã€€â”‚â– â”‚â– â”Œâ– â– â– â– â”Œâ– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– ã€€ã€€ã€€â”‚â– â”‚â– â– â– â– â”‚â– â– â– â– ",
		"â”‚â– ã€€â”‚â– â”‚â– â”‚â– â”€â”€â”˜â””â”€â”€â”â– â””â”€â”€â”â– â””â”€â”€â”â– â”‚â– â”€â”â– ã€€ã€€ã€€â”‚â– â”‚â– â”€â”â– â””â”€â”€â”â– ",
		"â”‚â– â– â– â– â”‚â– â”‚â– â– â– â– â”Œâ– â– â– â– ã€€ã€€ã€€â”‚â– â”Œâ– â– â– â– â”‚â– â– â– â– ã€€ã€€ã€€â”‚â– â”‚â– â– â– â– â”Œâ– â– â– â– ",
		"â””â”€â”€â”€â”˜â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜ã€€ã€€ã€€â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜ã€€ã€€ã€€â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜"
	}),
	({
		"â– â– â– â”â– â”â– â– â– â”â– â– â– â”â– â”â– â”â– â– â– â”â– â– â– â”â– â– â– â”â– â– â– â”â– â– â– â”",
		"â– â”Œâ– â”‚â– â”‚â””â”€â– â”‚â””â”€â– â”‚â– â”‚â– â”‚â– â”Œâ”€â”˜â– â”Œâ”€â”˜â””â”€â– â”‚â– â”Œâ– â”‚â– â”Œâ– â”‚",
		"â– â”‚â– â”‚â– â”‚â– â– â– â”‚â– â– â– â”‚â– â– â– â”‚â– â– â– â”â– â– â– â”ã€€ã€€â– â”‚â– â– â– â”‚â– â– â– â”‚",
		"â– â”‚â– â”‚â– â”‚â– â”Œâ”€â”˜â””â”€â– â”‚â””â”€â– â”‚â””â”€â– â”‚â– â”Œâ– â”‚ã€€ã€€â– â”‚â– â”Œâ– â”‚â””â”€â– â”‚",
		"â– â– â– â”‚â– â”‚â– â– â– â”â– â– â– â”‚ã€€ã€€â– â”‚â– â– â– â”‚â– â– â– â”‚ã€€ã€€â– â”‚â– â– â– â”‚â– â– â– â”‚",
		"â””â”€â”€â”˜â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜ã€€ã€€â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜ã€€ã€€â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜"
	}),
	({
		"â– â– â– â– â”â– â”â– â– â– â– â”â– â– â– â– â”â– â”ã€€â– â”â– â– â– â– â”â– â– â– â– â”â– â– â– â– â”â– â– â– â– â”â– â– â– â– â”",
		"â– â”Œâ”€â– â”‚â– â”‚â””â”€â”€â– â”‚â””â”€â”€â– â”‚â– â”‚ã€€â– â”‚â– â”Œâ”€â”€â”˜â– â”Œâ”€â”€â”˜â””â”€â”€â– â”‚â– â”Œâ”€â– â”‚â– â”Œâ”€â– â”‚",
		"â– â”‚ã€€â– â”‚â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– â”â– â– â– â– â”ã€€ã€€ã€€â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚",
		"â– â”‚ã€€â– â”‚â– â”‚â– â”Œâ”€â”€â”˜â””â”€â”€â– â”‚â””â”€â”€â– â”‚â””â”€â”€â– â”‚â– â”Œâ”€â– â”‚ã€€ã€€ã€€â– â”‚â– â”Œâ”€â– â”‚â””â”€â”€â– â”‚",
		"â– â– â– â– â”‚â– â”‚â– â– â– â– â”â– â– â– â– â”‚ã€€ã€€ã€€â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚ã€€ã€€ã€€â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚",
		"â””â”€â”€â”€â”˜â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜ã€€ã€€ã€€â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜ã€€ã€€ã€€â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜"
	}),
	({
		"â”Œâ”€â”€â”â”Œâ”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”â”Œâ”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”",
		"â”‚â– â– â– â”‚â– â””â– â– â– â””â– â– â– â”‚â– â”‚â– â”‚â– â– â– â”‚â– â– â– â””â– â– â– â”‚â– â– â– â”‚â– â– â– ",
		"â”‚â– â”‚â– â”‚â– â”Œâ”€â”€â– â”Œâ”€â”˜â– â”‚â– â”˜â– â”‚â– â”€â”â”‚â– â”€â”ã€€ã€€â”‚â– â”‚â– â”˜â– â”‚â– â”˜â– ",
		"â”‚â– â”‚â– â”‚â– â”‚â– â– â– â””â– â– â– â””â– â– â– â””â– â– â– â”‚â– â– â– ã€€ã€€â”‚â– â”‚â– â– â– â””â– â– â– ",
		"â”‚â– â”˜â– â”‚â– â”‚â– â”€â”â”Œâ”€â”˜â– ã€€ã€€â”‚â– â”Œâ”€â”˜â– â”‚â– â”˜â– ã€€ã€€â”‚â– â”‚â– â”˜â– â”Œâ”€â”€â– ",
		"â””â– â– â– â””â– â””â– â– â– â””â– â– â– ã€€ã€€â””â– â””â– â– â– â””â– â– â– ã€€ã€€â””â– â””â– â– â– â””â– â– â– "
	}),
	({
		"â”Œâ”€â”€â”€â”â”Œâ”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”ã€€â”Œâ”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”",
		"â”‚â– â– â– â– â”‚â– â””â– â– â– â– â””â– â– â– â– â”‚â– ã€€â”‚â– â”‚â– â– â– â– â”‚â– â– â– â– â””â– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– ",
		"â”‚â– ã€€â”‚â– â”‚â– â”Œâ”€â”€â”€â– â”Œâ”€â”€â”˜â– â”‚â– â”€â”˜â– â”‚â– â”€â”€â”â”‚â– â”€â”€â”ã€€ã€€ã€€â”‚â– â”‚â– â”€â”˜â– â”‚â– â”€â”˜â– ",
		"â”‚â– ã€€â”‚â– â”‚â– â”‚â– â– â– â– â””â– â– â– â– â””â– â– â– â– â””â– â– â– â– â”‚â– â– â– â– ã€€ã€€ã€€â”‚â– â”‚â– â– â– â– â””â– â– â– â– ",
		"â”‚â– â”€â”˜â– â”‚â– â”‚â– â”€â”€â”â”Œâ”€â”€â”˜â– ã€€ã€€ã€€â”‚â– â”Œâ”€â”€â”˜â– â”‚â– â”€â”˜â– ã€€ã€€ã€€â”‚â– â”‚â– â”€â”˜â– â”Œâ”€â”€â”€â– ",
		"â””â– â– â– â– â””â– â””â– â– â– â– â””â– â– â– â– ã€€ã€€ã€€â””â– â””â– â– â– â– â””â– â– â– â– ã€€ã€€ã€€â””â– â””â– â– â– â– â””â– â– â– â– "
	}),
	({
		"â”Œâ”€â”€â”â”Œâ”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”â”Œâ”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”",
		"â– â– â– â”‚â– â”‚â– â– â– â”‚â– â– â– â”‚â– â”‚â– â”‚â– â– â– â”˜â– â– â– â”˜â– â– â– â”‚â– â– â– â”‚â– â– â– â”‚",
		"â– â”‚â– â”‚â– â”‚â”Œâ”€â– â”‚â”Œâ”€â– â”‚â– â””â– â”‚â– â””â”€â”â– â””â”€â”ã€€ã€€â– â”‚â– â””â– â”‚â– â””â– â”‚",
		"â– â”‚â– â”‚â– â”‚â– â– â– â”˜â– â– â– â”‚â– â– â– â”‚â– â– â– â”‚â– â– â– â”‚ã€€ã€€â– â”‚â– â– â– â”‚â– â– â– â”‚",
		"â– â””â– â”‚â– â”‚â– â”€â”€â”â”Œâ”€â– â”‚ã€€ã€€â– â”‚â”Œâ”€â– â”‚â– â””â– â”‚ã€€ã€€â– â”‚â– â””â– â”‚â”Œâ”€â– â”‚",
		"â– â– â– â”˜â– â”˜â– â– â– â”˜â– â– â– â”˜ã€€ã€€â– â”˜â– â– â– â”˜â– â– â– â”˜ã€€ã€€â– â”˜â– â– â– â”˜â– â– â– â”˜"
	}),
	({
		"â”Œâ”€â”€â”€â”â”Œâ”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”ã€€â”Œâ”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”",
		"â– â– â– â– â”‚â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚â– â”‚ã€€â– â”‚â– â– â– â– â”˜â– â– â– â– â”˜â– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚",
		"â– â”‚ã€€â– â”‚â– â”‚â”Œâ”€â”€â– â”‚â”Œâ”€â”€â– â”‚â– â””â”€â– â”‚â– â””â”€â”€â”â– â””â”€â”€â”ã€€ã€€ã€€â– â”‚â– â””â”€â– â”‚â– â””â”€â– â”‚",
		"â– â”‚ã€€â– â”‚â– â”‚â– â– â– â– â”˜â– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚ã€€ã€€ã€€â– â”‚â– â– â– â– â”‚â– â– â– â– â”‚",
		"â– â””â”€â– â”‚â– â”‚â– â”€â”€â”€â”â”Œâ”€â”€â– â”‚ã€€ã€€ã€€â– â”‚â”Œâ”€â”€â– â”‚â– â””â”€â– â”‚ã€€ã€€ã€€â– â”‚â– â””â”€â– â”‚â”Œâ”€â”€â– â”‚",
		"â– â– â– â– â”˜â– â”˜â– â– â– â– â”˜â– â– â– â– â”˜ã€€ã€€ã€€â– â”˜â– â– â– â– â”˜â– â– â– â– â”˜ã€€ã€€ã€€â– â”˜â– â– â– â– â”˜â– â– â– â– â”˜"
	}),*/
	({
		"â”Œâ”€â”€â”â”Œâ”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”â”Œâ”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”â”Œâ”€â”€â”",
		"â”‚â”Œâ”â”‚â”‚â”‚â””â”€â”â”‚â””â”€â”â”‚â”‚â”‚â”‚â”‚â”‚â”Œâ”€â”˜â”‚â”Œâ”€â”˜â””â”€â”â”‚â”‚â”Œâ”â”‚â”‚â”Œâ”â”‚",
		"â”‚â”‚â”‚â”‚â”‚â”‚â”Œâ”€â”˜â”‚â”Œâ”€â”˜â”‚â”‚â””â”˜â”‚â”‚â””â”€â”â”‚â””â”€â”ã€€ã€€â”‚â”‚â”‚â””â”˜â”‚â”‚â””â”˜â”‚",
		"â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”Œâ”€â”˜â””â”€â”â”‚â””â”€â”â”‚â””â”€â”â”‚â”‚â”Œâ”â”‚ã€€ã€€â”‚â”‚â”‚â”Œâ”â”‚â””â”€â”â”‚",
		"â”‚â””â”˜â”‚â”‚â”‚â”‚â””â”€â”â”Œâ”€â”˜â”‚ã€€ã€€â”‚â”‚â”Œâ”€â”˜â”‚â”‚â””â”˜â”‚ã€€ã€€â”‚â”‚â”‚â””â”˜â”‚â”Œâ”€â”˜â”‚",
		"â””â”€â”€â”˜â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜ã€€ã€€â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜ã€€ã€€â””â”˜â””â”€â”€â”˜â””â”€â”€â”˜"
	}),
	({
		"â”Œâ”€â”€â”€â”â”Œâ”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”ã€€â”Œâ”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”",
		"â”‚â”Œâ”€â”â”‚â”‚â”‚â””â”€â”€â”â”‚â””â”€â”€â”â”‚â”‚â”‚ã€€â”‚â”‚â”‚â”Œâ”€â”€â”˜â”‚â”Œâ”€â”€â”˜â””â”€â”€â”â”‚â”‚â”Œâ”€â”â”‚â”‚â”Œâ”€â”â”‚",
		"â”‚â”‚ã€€â”‚â”‚â”‚â”‚â”Œâ”€â”€â”˜â”‚â”Œâ”€â”€â”˜â”‚â”‚â””â”€â”˜â”‚â”‚â””â”€â”€â”â”‚â””â”€â”€â”ã€€ã€€ã€€â”‚â”‚â”‚â””â”€â”˜â”‚â”‚â””â”€â”˜â”‚",
		"â”‚â”‚ã€€â”‚â”‚â”‚â”‚â”‚â”Œâ”€â”€â”˜â””â”€â”€â”â”‚â””â”€â”€â”â”‚â””â”€â”€â”â”‚â”‚â”Œâ”€â”â”‚ã€€ã€€ã€€â”‚â”‚â”‚â”Œâ”€â”â”‚â””â”€â”€â”â”‚",
		"â”‚â””â”€â”˜â”‚â”‚â”‚â”‚â””â”€â”€â”â”Œâ”€â”€â”˜â”‚ã€€ã€€ã€€â”‚â”‚â”Œâ”€â”€â”˜â”‚â”‚â””â”€â”˜â”‚ã€€ã€€ã€€â”‚â”‚â”‚â””â”€â”˜â”‚â”Œâ”€â”€â”˜â”‚",
		"â””â”€â”€â”€â”˜â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜ã€€ã€€ã€€â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜ã€€ã€€ã€€â””â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜"
	})
});

string ans="", ans1, fakeans="";
string str = "\né“¶ç¿¼æ€æ‰‹è¯´é“ï¼šè¯·ç”¨ answer å›ç­”ï¼Œä¸‹é¢è¿™è¡Œæ•°å­—æ˜¯ï¼Ÿ\n";
int aflag;
int num = 2;

#include "antirobot.h";

void question()
{
	message("channel", HIW+str+NOR, ob);
	aflag = 1;
}

int do_answer(string arg)
{
	object me = this_object();
	int len = strlen(ans);

	if (arg && aflag) {
		if (ans1 == arg) command("wiz "+ob->query("id")+" æå¯èƒ½ä½¿ç”¨äº†è‡ªåŠ¨åº”ç­”æœºå™¨äººï¼Œè¯·æ£€æŸ¥ï¼");
		else ans1 = arg;
		aflag = 0;
	}
	if (strlen(arg) != len) return notify_fail("ç­”æ¡ˆçš„é•¿åº¦ä¸å¯¹ï¼Œå†ä»”ç»†çœ‹çœ‹ã€‚\n");
	if (arg==ans) {
		message_vision("$Nç‚¹äº†ç‚¹å¤´ï¼Œè¯´é“ï¼šOKï¼Œ$nç»§ç»­å¿™å§ã€‚\n", me, ob);
		message_vision("$Nçªç„¶æ¶ˆå¤±ä¸è§äº†ã€‚\n", me);
	} else {
		if (arg==fakeans) command("wiz "+ob->query("id")+" ç»å¯¹ä½¿ç”¨äº†è‡ªåŠ¨åº”ç­”æœºå™¨äººï¼Œè¯·é€®æ•ï¼");
		if (num--) return notify_fail("ç­”æ¡ˆä¸å¯¹ï¼Œå†ä»”ç»†çœ‹çœ‹ã€‚\n");
		else {
			message_vision("$Nå¹äº†å£æ°”é“ï¼š"+arg+"ï¼Ÿ"+ans+"æ‰å¯¹ï¼Œè¿™ä¹ˆç®€å•éƒ½ç­”ä¸å‡ºï¼Ÿå»æ³•åº­æ¥å—è†è®¯å§ï¼\n", me);
			move_to_court(ob);
		}
	}
	destruct(this_object());
	return 1;
}

void test_robot(object obj)
{
	int len, temp, c, l, font, pos, end;
	string *line=({"", "", "", "", "", ""}), ta = "";
	string *line1=({"", "", "", "", "", ""}), gap;
	object me = this_object();

	ob = obj;
	if (environment(ob) && !ob->is_fighting()) {
		message("channel", "é“¶ç¿¼æ€æ‰‹ç•¥å¸¦æ­‰æ„åœ°è¯´ï¼šâ€œæœºå™¨äººç¨½æŸ¥ï¼Œä¾‹è¡Œå…¬äº‹ï¼Œè¯·å›ç­”ä¸€ä¸ªå°é—®é¢˜ã€‚â€\n", ob);
		message("channel", "å¦‚æœåˆ©ç”¨æœºå™¨è‡ªåŠ¨å›ç­”é—®é¢˜ï¼Œæ¡£æ¡ˆå°†è¢«æ— æ¡ä»¶åˆ é™¤ã€‚\n", ob);
		for (l = 0; l < FONTLIB; l++)
			for (temp = 1; temp < 10; temp++)
				keypos[l][temp] = keypos[l][temp-1] + keylen[l][temp-1];

		// ç”Ÿæˆç­”æ¡ˆ
		temp = len = random(2) + 2;
		while (temp--) {
			ans += "0";
			ans[<1] += random(10);
			fakeans += "0";
			fakeans[<1] += ans[<1] == '1'?1:2+random(8);
		}

		for (temp = 0; temp < len; temp++) {
			gap = repeat_string("ã€€", 1+random(3));
			c = ans[temp] - '0';
			font = random(FONTLIB);
			pos = keypos[font][c];
			end = pos + keylen[font][c] -1;
			for (l = 0; l < 6; l++)
				line[l] += gap + key[font][l][pos..end];
			c = fakeans[temp] - '0';
			pos = keypos[font][c];
			end = pos + keylen[font][c] -1;
			for (l = 0; l < 6; l++)
				line1[l] += gap + key[font][l][pos..end];
		}
		for (l = -1; l < strlen(strip(line[0]))/2; l++) ta += "ã€€";
		ta += "\n";
		str += HW + ta;
		for (l = 0; l < 6; l++)
			str += (random(3)?"":line1[l] + "ã€€\n[A") + line[l] + "ã€€" +(random(2)?"":" ") + "\n";
		str += ta;
//* å¹²æ‰°å­—ç¬¦
		for (l = 50; l < strlen(str); l++) {
			if (str[l] < 161) continue;
			if (str[l..l+1] == "ã€€") {
				if (!random(3)) {
					string *tab = key[random(FONTLIB)];

					ta = tab[random(sizeof(tab))];
					c = random(sizeof(ta)/2)*2;
					str = str[0..l-1]
						+ BK + ta[c..c+1]
						+ HW + str[l+2..<1];
					l += strlen(BK+HW);
				}
			}
			l++;
		}
//*/
		timer = 180;
		call_out("test1", 10);
		me->move(ob, 1);
	} else destruct(me);
}
